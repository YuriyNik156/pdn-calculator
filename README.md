# Микросервис для расчёта платежной долговой нагрузки (PDN Calculator)

**Описание**

Сервис предназначен для расчёта платёжной долговой нагрузки (PDN) для физических лиц.
Он предоставляет REST API, позволяющий рассчитать PDN в двух режимах — base и stress, с учётом кредитов, карт, 
доходов и параметров клиента.
Проект создаётся как тестовое задание и демонстрирует навыки работы с FastAPI, Pydantic, Docker и pytest.

---

**Сервис поддерживает:**

    * строгую валидацию входных данных;
    * нормализацию периодичности платежей;
    * учёт кредитных карт с минимальным платёжным порогом;
    * аудит запросов с маскированием персональных данных;
    * автоматическую документацию API (OpenAPI/Swagger);
    * базовые тесты и структуру проекта, готовую для расширения.

---

## Основные возможности

**Расчёт PDN**

    * POST /pdn/calc — расчёт PDN для физических лиц (subject_type=individual)
    * Поддержка режимов:
        * base — базовый расчёт
        * stress — стресс-сценарий (при ухудшенных условиях)

    * Валидация и нормализация данных
        * Проверка типов и обязательных полей (через Pydantic)
        * Приведение периодичности платежей к месячной
        * Поддержка минимальных платежей для кредитных карт
    * Результат расчёта
        * calc_version, risk_band, breakdown, meta.ts

    * Пример:

    ```bash
    {
      "calc_version": "1.0.0",
      "risk_band": "medium",
      "breakdown": {"pdn_ratio": 0.25},
      "meta": {"ts": "2025-10-20T10:00:00Z"}
    }
   ```

Логирование с маскированием PII

Аудит всех запросов и ответов в консоль или файл

Персональные данные заменяются символами ***

Документация API

Автоматически генерируется по адресу /docs
---